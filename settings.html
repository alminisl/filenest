<head>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="./settings.css">
</head>


<body class="bg-gray-200">
    <div class="container mx-auto px-4 py-8">
        <h1 class="text-2xl font-bold">
            Settings
        </h1>

        <div style="p-4 bg-white rounded-lg shadow-lg">
            <!-- <div>
            <small><i>Please note: Adding extensions should be done with separating "," and must include a
                    "." before it (example: .pdf, .doc..)</i></small>
        </div> -->


            <div class="grid gap-8 md:grid-cols-3">
                <h1 class="text-2xl font-bold mb-4">Set the path:</h1>
                <div id="pathFields">
                    <!-- Add Path Fields Here -->
                </div>
                <h1 class="text-2xl font-bold mb-4">Set the extensions:</h1>
                <hr class="border-t-2 border-gray-400 mb-4">

                <div id="extensionFields">
                    <!-- Add Extension Fields Here -->
                </div>
            </div>
        </div>
        <div class="mt-8">
            <label id="message" class="text-green-500"></label>
            <button
                class="text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 focus:outline-none"
                onclick="save()">
                Save
            </button>
        </div>
    </div>

    <script>
        const electron = require('electron');
        const { ipcRenderer } = electron;

        function addPathFields(config) {
            const pathFields = document.getElementById("pathFields");
            console.log("CONFIG", config)
            for (const pathName in config) {
                if (config.hasOwnProperty(pathName)) {
                    const path = config[pathName];

                    const field = document.createElement("div");
                    field.classList.add("grid", "gap-2", "md:gap-6", "md:grid-cols-2", "items-center");
                    field.style.padding = "5px";

                    const label = document.createElement("label");
                    label.classList.add("block", "text-sm", "font-medium");
                    label.textContent = `${pathName} Path: `;
                    field.appendChild(label);

                    const input = document.createElement("input");
                    input.type = "text";
                    input.value = path;
                    input.classList.add("bg-gray-100", "border", "border-gray-300", "text-gray-900", "text-sm", "rounded-lg", "focus:ring-blue-500", "focus:border-blue-500", "block", "w-full", "p-2.5")
                    input.id = `${pathName.toLowerCase()}path`;
                    field.appendChild(input);
                    pathFields.appendChild(field);
                }
            }
        }

        function addExtensionsFields(arg) {
            const extensionFields = document.getElementById("extensionFields");

        }

        function save() {
            const pathsAndExt = {
                ImagesPath: ImagesPath.value,
                ArchivePath: ArchivePath.value,
                basePathSetting: basePathSetting.value,
                ApplicationPath: ApplicationPath.value,
                DocumentPath: DocumentPath.value,
                documentX: documentX.map(x => x.trim().replace(/\s/g, '')),
                applicationX: applicationX.map(x => x.trim().replace(/\s/g, '')),
                imageX: imageX.map(x => x.trim().replace(/\s/g, '')),
                archiveX: archiveX.map(x => x.trim().replace(/\s/g, '')),
            }

            const message = document.querySelector("#message")
            message.style.color = "green"
            message.innerHTML = "Successfully Saved!"
            setTimeout(function () { message.style.display = "none" }, 5000)
            ipcRenderer.send("saveToConfig", pathsAndExt);
        }

        //onLoad event
        ipcRenderer.on("reply-paths", (event, arg) => {
            addPathFields(arg)
        })
        ipcRenderer.send('onload-paths', 'Load paths..')

        ipcRenderer.on("reply-extensions", (event, arg) => {
            addPathFields(arg)
        })
        ipcRenderer.send('onload-extensions', 'Load extensions..')

    </script>
</body>

</html>